<!DOCTYPE html>
<html>
<head>
    <title>Assignment Spreadsheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
        }
        #controls {
            margin-bottom: 20px;
            text-align: center;
        }
        #controls button {
            margin: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #000;
            padding: 5px;
            text-align: center;
            word-wrap: break-word;
        }
        th[contenteditable="true"]:focus, td[contenteditable="true"]:focus {
            outline: 2px solid blue;
        }
        .score-select, .skill-select {
            width: 100%;
            padding: 2px;
            color: #000;
            font-weight: bold;
            border: none;
            outline: none;
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
        }
        .score-4 {
            background-color: #00c5ff;
        }
        .score-3 {
            background-color: #00ff04;
        }
        .score-2 {
            background-color: #fdff00;
        }
        .score-1 {
            background-color: #ff1837;
        }
        .score-N {
            background-color: #ff00a7;
        }
        .score-default {
            background-color: #cccccc; /* Gray for default */
        }
        .chart-container {
            width: 100%;
            position: relative;
            height: 150px; /* Adjust as needed */
            margin-bottom: 20px;
        }
        .chart-wrapper {
            position: absolute;
            top: 0;
            /* width and left position will be set dynamically */
        }
        .chart-wrapper canvas {
            width: 100% !important;
            height: 150px !important; /* Match the container height */
        }
        #downloadBtn {
            display: block;
            margin: 20px auto;
        }
        /* Adjust table column widths */
        #gradeTable th, #gradeTable td {
            width: 80px;
        }
        /* Narrower columns for Letter and SEP averages */
        .narrow-column {
            width: 30px; /* Reduced from 50px to 30px */
        }
        /* Wider column for Student names */
        #gradeTable th:first-child, #gradeTable td:first-child {
            width: 150px; /* Adjust as needed for the 'Student' column */
        }
        /* Style for the proficiency percentage row */
        .proficiency-row th {
            font-weight: bold;
            background-color: #f0f0f0;
        }
        /* Style for the letter grade column */
        .letter-grade {
            font-weight: bold;
        }
        /* Rotate text in header cells */
        .vertical-text {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <h1>Assignment Spreadsheet</h1>

    <div id="controls">
        <button id="addStudentBtn">Add Student</button>
        <button id="addSkillBtn">Add Column</button>
        <button id="downloadBtn">Download PDF</button>
    </div>

    <div class="chart-container" id="chartContainer">
        <!-- Charts will be added here -->
    </div>

    <table id="gradeTable">
        <thead>
            <!-- Proficiency Percentage Row -->
            <tr id="proficiencyRow" class="proficiency-row">
                <th colspan="2"></th>
                <th class="narrow-column"></th>
                <th class="narrow-column"></th>
                <th class="narrow-column"></th>
                <!-- Percentages will be added here -->
            </tr>
            <tr id="skillRow">
                <th contenteditable="false">Student</th>
                <th contenteditable="false" class="narrow-column">Letter</th>
                <th class="vertical-text narrow-column">SEP2 Avg</th>
                <th class="vertical-text narrow-column">SEP4 Avg</th>
                <th class="vertical-text narrow-column">SEP6 Avg</th>
                <!-- Skill dropdowns will be added here -->
            </tr>
            <tr id="assessmentRow">
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <!-- Assessment names will be added here -->
            </tr>
        </thead>
        <tbody>
            <!-- Student rows will be added here -->
        </tbody>
    </table>

    <!-- Include Chart.js, ChartDataLabels, jsPDF, and html2canvas from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas"></script>

    <script>
        // (JavaScript code remains unchanged from the previous version)
        // The only change is in the CSS for .narrow-column class
        // Rest of the code is the same as before
    </script>
</body>
</html>
